{"ast":null,"code":"import _objectSpread from\"C:/Users/AZIZ/Desktop/gen_meme/client/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState,useRef,useEffect}from'react';import axios from'axios';import html2canvas from'html2canvas';import toast from'react-hot-toast';import'./component.css';import InteractifGen from'./InteractifGen';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const MemeGenerator=()=>{const[selectedImages,setSelectedImages]=useState([]);const[imageUrl,setImageUrl]=useState('');const[cloudinaryId,setCloudinaryId]=useState('');const[topText,setTopText]=useState('');const[bottomText,setBottomText]=useState('');const[title,setTitle]=useState('');const[isUploading,setIsUploading]=useState(false);const[isSaving,setIsSaving]=useState(false);const[preview,setPreview]=useState(null);const[displayMode,setDisplayMode]=useState('single');const[customTexts,setCustomTexts]=useState([]);const[textEditMode,setTextEditMode]=useState(false);const[activeImageIndex,setActiveImageIndex]=useState(0);const[textColor,setTextColor]=useState('#ffffff');const[textBgColor,setTextBgColor]=useState('#000000');const[textBgOpacity,setTextBgOpacity]=useState(0.7);const[editingText,setEditingText]=useState('');const[showCustomEditor,setShowCustomEditor]=useState(false);const memeRef=useRef(null);const canvasRef=useRef(null);function hexToRgba(hex,opacity){const r=parseInt(hex.slice(1,3),16);const g=parseInt(hex.slice(3,5),16);const b=parseInt(hex.slice(5,7),16);return\"rgba(\".concat(r,\", \").concat(g,\", \").concat(b,\", \").concat(opacity,\")\");}const displayModes={single:{name:'Image unique',maxImages:1},horizontal:{name:'Horizontal (2)',maxImages:2},vertical:{name:'Vertical (2)',maxImages:2},grid2x2:{name:'Grille 2x2',maxImages:4}};const handleImageUpload=async event=>{const files=Array.from(event.target.files);const maxImages=displayModes[displayMode].maxImages;if(selectedImages.length+files.length>maxImages){toast.error(\"Maximum \".concat(maxImages,\" image(s) pour ce mode d'affichage\"));return;}const validFiles=files.filter(file=>{if(file.size>5*1024*1024){toast.error(\"\".concat(file.name,\" est trop volumineux (max 5MB)\"));return false;}return true;});const newImages=validFiles.map(file=>({file,preview:URL.createObjectURL(file),id:Date.now()+Math.random()}));setSelectedImages(prev=>[...prev,...newImages]);if(validFiles.length>0){setIsUploading(true);setTimeout(()=>setIsUploading(false),1000);}};const removeImage=imageId=>{setSelectedImages(prev=>{const updated=prev.filter(img=>img.id!==imageId);// Libérer l'URL de l'image supprimée\nconst removedImage=prev.find(img=>img.id===imageId);if(removedImage){URL.revokeObjectURL(removedImage.preview);}return updated;});// Nettoyer les textes personnalisés associés à cette image\nsetCustomTexts(prev=>prev.filter(text=>text.imageIndex!==imageId));};const handleCanvasClick=event=>{if(!textEditMode||selectedImages.length===0)return;const canvas=canvasRef.current;if(!canvas)return;const img=event.target;const rect=img.getBoundingClientRect();const x=(event.clientX-rect.left)/rect.width*img.naturalWidth;const y=(event.clientY-rect.top)/rect.height*img.naturalHeight;const newText={id:Date.now(),text:'Nouveau texte',x:x,y:y,imageIndex:activeImageIndex,color:textColor,bgColor:textBgColor,bgOpacity:textBgOpacity,isEditing:true};setCustomTexts(prev=>[...prev,newText]);};const updateCustomText=(textId,newText)=>{setCustomTexts(prev=>prev.map(t=>t.id===textId?_objectSpread(_objectSpread({},t),{},{text:newText,isEditing:false}):t));};const removeCustomText=textId=>{setCustomTexts(prev=>prev.filter(t=>t.id!==textId));};const generateMemeImage=async()=>{if(selectedImages.length===0)return null;return new Promise((resolve,reject)=>{const canvas=document.createElement(\"canvas\");const ctx=canvas.getContext(\"2d\");// Dimensions du canvas selon le mode d'affichage\nlet canvasWidth=800;let canvasHeight=600;if(displayMode==='horizontal'){canvasWidth=1200;canvasHeight=600;}else if(displayMode==='vertical'){canvasWidth=600;canvasHeight=1200;}else if(displayMode==='grid2x2'){canvasWidth=1000;canvasHeight=1000;}canvas.width=canvasWidth;canvas.height=canvasHeight;let imagesLoaded=0;const totalImages=selectedImages.length;const drawTextsOnCanvas=()=>{// Texte du haut (global)\nif(topText){const topFontSize=Math.floor(canvasWidth/15);const topTextY=20;ctx.font=\"bold \".concat(topFontSize,\"px Impact\");ctx.textAlign=\"center\";ctx.textBaseline=\"top\";const textMetrics=ctx.measureText(topText);// CORRIGÉ\nconst textWidth=textMetrics.width;const textHeight=topFontSize;if(textBgOpacity>0){const padding=10;const rectX=canvasWidth/2-textWidth/2-padding;const rectY=topTextY-padding/2;const rectWidth=textWidth+padding*2;const rectHeight=textHeight+padding;ctx.fillStyle=hexToRgba(textBgColor,textBgOpacity);// CORRIGÉ\nctx.fillRect(rectX,rectY,rectWidth,rectHeight);}ctx.fillStyle=textColor;ctx.strokeStyle=\"#000000\";ctx.lineWidth=3;ctx.strokeText(topText,canvasWidth/2,topTextY);ctx.fillText(topText,canvasWidth/2,topTextY);}if(bottomText){const bottomFontSize=Math.floor(canvasWidth/15);const bottomTextY=canvasHeight-60;ctx.font=\"bold \".concat(bottomFontSize,\"px Impact\");ctx.textAlign=\"center\";ctx.textBaseline=\"bottom\";const textMetrics=ctx.measureText(bottomText);const textWidth=textMetrics.width;const textHeight=bottomFontSize;if(textBgOpacity>0){const padding=10;const rectX=canvasWidth/2-textWidth/2-padding;const rectY=bottomTextY-textHeight-padding/2;const rectWidth=textWidth+padding*2;const rectHeight=textHeight+padding;ctx.fillStyle=hexToRgba(textBgColor,textBgOpacity);// CORRIGÉ\nctx.fillRect(rectX,rectY,rectWidth,rectHeight);}ctx.fillStyle=textColor;ctx.strokeStyle=\"#000000\";ctx.lineWidth=3;ctx.strokeText(bottomText,canvasWidth/2,bottomTextY);ctx.fillText(bottomText,canvasWidth/2,bottomTextY);}customTexts.forEach(textObj=>{if(textObj.text&&!textObj.isEditing){const fontSize=Math.floor(canvasWidth/20);ctx.font=\"bold \".concat(fontSize,\"px Impact\");ctx.textAlign=\"center\";ctx.textBaseline=\"middle\";// Fond du texte si nécessaire\nif(textObj.bgOpacity>0){const textWidth=ctx.measureText(textObj.text).width;const padding=10;ctx.fillStyle=\"\".concat(textObj.bgColor).concat(Math.floor(textObj.bgOpacity*255).toString(16).padStart(2,'0'));ctx.fillRect(textObj.x-textWidth/2-padding,textObj.y-fontSize/2-padding/2,textWidth+padding*2,fontSize+padding);}// Texte\nctx.fillStyle=textObj.color;ctx.strokeStyle=\"#000000\";ctx.lineWidth=2;ctx.strokeText(textObj.text,textObj.x,textObj.y);ctx.fillText(textObj.text,textObj.x,textObj.y);}});};const onImageLoad=()=>{imagesLoaded++;if(imagesLoaded===totalImages){drawTextsOnCanvas();canvas.toBlob(blob=>{if(blob){const url=URL.createObjectURL(blob);setPreview(url);resolve(blob);}else{reject(new Error(\"Échec génération meme\"));}},\"image/png\");}};// Dessiner les images selon le mode d'affichage\nselectedImages.forEach((imageData,index)=>{const img=new Image();img.onload=()=>{let x=0,y=0,width=canvasWidth,height=canvasHeight;if(displayMode==='horizontal'&&selectedImages.length===2){width=canvasWidth/2;x=index*width;}else if(displayMode==='vertical'&&selectedImages.length===2){height=canvasHeight/2;y=index*height;}else if(displayMode==='grid2x2'){width=canvasWidth/2;height=canvasHeight/2;x=index%2*width;y=Math.floor(index/2)*height;}// Remplir la zone avec un fond blanc\nctx.fillStyle=\"white\";ctx.fillRect(x,y,width,height);// Maintenir le ratio d'aspect et centrer\nconst aspectRatio=img.width/img.height;const targetAspect=width/height;let drawWidth=width;let drawHeight=height;let offsetX=0;let offsetY=0;if(aspectRatio>targetAspect){// Image plus large que la case\ndrawWidth=width;drawHeight=width/aspectRatio;offsetY=(height-drawHeight)/2;}else{// Image plus haute que la case\ndrawHeight=height;drawWidth=height*aspectRatio;offsetX=(width-drawWidth)/2;}ctx.drawImage(img,x+offsetX,y+offsetY,drawWidth,drawHeight);onImageLoad();};img.onerror=()=>{console.error(\"Erreur chargement image\");onImageLoad();};img.src=imageData.preview;});});};const handleChangeTop=event=>{setTopText(event.target.value);};const handleChangeBot=event=>{setBottomText(event.target.value);};useEffect(()=>{if(selectedImages.length>0){const timeoutId=setTimeout(()=>{generateMemeImage().catch(console.error);},300);return()=>clearTimeout(timeoutId);}},[selectedImages,topText,bottomText,customTexts,displayMode,textColor,textBgColor,textBgOpacity]);const handleSaveMeme=async()=>{if(!title.trim()){toast.error('Veuillez ajouter un titre');return;}setIsSaving(true);try{// Étape 1: Générer et uploader l'image\nconst blob=await generateMemeImage();if(!blob){toast.error(\"Impossible de générer l'image\");return;}const formData=new FormData();formData.append('image',blob,'meme.png');// Upload vers Cloudinary\nconst uploadResponse=await axios.post(\"http://localhost:5000/api/upload\",formData,{headers:{'Content-Type':'multipart/form-data'}});// Étape 2: Sauvegarder les métadonnées en base de données\nconst memeData={title:title.trim(),imageUrl:uploadResponse.data.imageUrl,cloudinaryId:uploadResponse.data.cloudinaryId};await axios.post('http://localhost:5000/api/memes',memeData);toast.success('Meme sauvegardé avec succès!');resetForm();}catch(error){var _error$response,_error$response$data;console.error('Erreur:',error);toast.error(((_error$response=error.response)===null||_error$response===void 0?void 0:(_error$response$data=_error$response.data)===null||_error$response$data===void 0?void 0:_error$response$data.message)||'Erreur lors de la sauvegarde');}finally{setIsSaving(false);}};const handleDownload=async()=>{if(!preview)return;try{const response=await fetch(preview);const blob=await response.blob();const url=URL.createObjectURL(blob);const link=document.createElement('a');link.download=\"\".concat(title||'meme',\".png\");link.href=url;link.click();URL.revokeObjectURL(url);toast.success('Meme téléchargé!');}catch(error){console.error('Erreur téléchargement:',error);toast.error('Erreur lors du téléchargement');}};const resetForm=()=>{selectedImages.forEach(img=>URL.revokeObjectURL(img.preview));setSelectedImages([]);setImageUrl('');setCloudinaryId('');setTopText('');setBottomText('');setTitle('');setCustomTexts([]);setPreview(null);setActiveImageIndex(0);};const handleShare=async()=>{if(!preview)return;try{const response=await fetch(preview);const blob=await response.blob();const file=new File([blob],'meme.png',{type:blob.type});if(navigator.canShare&&navigator.canShare({files:[file]})){await navigator.share({title:\"Meme: \".concat(title),text:\"Regardez ce meme que j'ai cr\\xE9\\xE9 : \".concat(title),files:[file]});}else{navigator.clipboard.writeText(preview);toast.success('URL copiée dans le presse-papier');}}catch(error){console.error(\"Erreur lors du partage:\",error);toast.error(\"Partage impossible.\");}};// CANVA \nconst handleCustomEditorSave=canvasData=>{// Ici vous pouvez traiter les données du canvas personnalisé\n// Par exemple, les sauvegarder ou les intégrer à votre flux existant\nconsole.log('Canvas personnalisé sauvegardé:',canvasData);setShowCustomEditor(false);};return/*#__PURE__*/_jsxs(\"div\",{className:\"meme-generator px-4 py-8 max-w-6xl mx-auto text-white \",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"text-4xl font-bold mb-8 text-center\",children:\"Cr\\xE9ateur de Memes\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"mb-6\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>setShowCustomEditor(true),className:\"w-full flex items-center justify-center gap-3 px-6 py-4 bg-gradient-to-r from-purple-500 to-pink-500 text-white font-semibold rounded-xl hover:from-purple-600 hover:to-pink-600 transition-all duration-300 shadow-lg hover:shadow-xl transform hover:scale-105\",children:/*#__PURE__*/_jsx(\"span\",{children:\"Mode Personnalisation\"})}),/*#__PURE__*/_jsx(\"p\",{className:\"text-center text-sm text-white/70 mt-2\",children:\"Cr\\xE9ez librement avec des outils de type Canva\"})]}),showCustomEditor&&/*#__PURE__*/_jsx(InteractifGen,{onClose:()=>setShowCustomEditor(false),onSave:handleCustomEditorSave}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white/10 backdrop-blur-lg rounded-2xl p-6 shadow-2xl\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-2xl font-semibold mb-4\",children:\"1. Mode d'affichage\"}),/*#__PURE__*/_jsx(\"div\",{className:\"grid grid-cols-2 lg:grid-cols-4 gap-2 mb-6\",children:Object.entries(displayModes).map(_ref=>{let[mode,info]=_ref;return/*#__PURE__*/_jsxs(\"button\",{onClick:()=>{setDisplayMode(mode);// Limiter les images selon le nouveau mode\nconst maxImages=info.maxImages;if(selectedImages.length>maxImages){const excess=selectedImages.slice(maxImages);excess.forEach(img=>URL.revokeObjectURL(img.preview));setSelectedImages(prev=>prev.slice(0,maxImages));}},className:\"p-3 rounded-lg border-2 transition \".concat(displayMode===mode?'border-blue-400 bg-blue-500/30':'border-white/30 bg-white/10 hover:bg-white/20'),children:[/*#__PURE__*/_jsx(\"div\",{className:\"text-sm font-medium\",children:info.name}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-xs opacity-75\",children:[\"Max: \",info.maxImages]})]},mode);})}),/*#__PURE__*/_jsx(\"h2\",{className:\"text-2xl font-semibold mb-4\",children:\"2. Ajouter des images\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"mb-6\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"image-upload\",className:\"cursor-pointer block w-full text-center py-4 border-2 border-dashed border-white/50 rounded-xl hover:bg-white/10 transition\",children:isUploading?\"📤 Upload en cours...\":\"\\uD83D\\uDCF8 Ajouter des images (\".concat(selectedImages.length,\"/\").concat(displayModes[displayMode].maxImages,\")\")}),/*#__PURE__*/_jsx(\"input\",{id:\"image-upload\",type:\"file\",accept:\"image/*\",multiple:displayModes[displayMode].maxImages>1,onChange:handleImageUpload,className:\"hidden\"})]}),selectedImages.length>0&&/*#__PURE__*/_jsx(\"div\",{className:\"grid grid-cols-2 lg:grid-cols-4 gap-4 mb-6\",children:selectedImages.map((img,index)=>/*#__PURE__*/_jsxs(\"div\",{className:\"relative group\",children:[/*#__PURE__*/_jsx(\"img\",{src:img.preview,alt:\"Upload \".concat(index+1),className:\"w-full h-24 object-cover rounded-lg border-2 cursor-pointer transition \".concat(activeImageIndex===index?'border-blue-400':'border-white/30'),onClick:()=>setActiveImageIndex(index)}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>removeImage(img.id),className:\"absolute -top-2 -right-2 bg-red-500 text-white rounded-full w-6 h-6 flex items-center justify-center text-xs opacity-0 group-hover:opacity-100 transition\",children:\"\\u2715\"}),activeImageIndex===index&&/*#__PURE__*/_jsx(\"div\",{className:\"absolute inset-0 bg-blue-500/20 rounded-lg flex items-center justify-center\",children:/*#__PURE__*/_jsx(\"span\",{className:\"text-xs font-bold\",children:\"ACTIF\"})})]},img.id))}),selectedImages.length>0&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-2xl font-semibold mb-4\",children:\"3. Configuration du texte\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 lg:grid-cols-3 gap-4 mb-6\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm mb-2\",children:\"Couleur du texte\"}),/*#__PURE__*/_jsx(\"input\",{type:\"color\",value:textColor,onChange:e=>setTextColor(e.target.value),className:\"w-full h-10 rounded border-none\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm mb-2\",children:\"Couleur du fond\"}),/*#__PURE__*/_jsx(\"input\",{type:\"color\",value:textBgColor,onChange:e=>setTextBgColor(e.target.value),className:\"w-full h-10 rounded border-none\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"label\",{className:\"block text-sm mb-2\",children:[\"Opacit\\xE9 du fond: \",Math.round(textBgOpacity*100),\"%\"]}),/*#__PURE__*/_jsx(\"input\",{type:\"range\",min:\"0\",max:\"1\",step:\"0.1\",value:textBgOpacity,onChange:e=>setTextBgOpacity(parseFloat(e.target.value)),className:\"w-full\"})]})]}),/*#__PURE__*/_jsx(\"h2\",{className:\"text-2xl font-semibold mb-4\",children:\"4. Ajouter du texte\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 sm:grid-cols-2 gap-4 mb-4\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Titre du meme\",value:title,onChange:e=>setTitle(e.target.value),className:\"bg-white/20 border border-white/30 text-white px-4 py-2 rounded-lg placeholder-white sm:col-span-2\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Texte du haut\",value:topText,onChange:handleChangeTop,className:\"bg-white/20 border border-white/30 text-white px-4 py-2 rounded-lg placeholder-white\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Texte du bas\",value:bottomText,onChange:handleChangeBot,className:\"bg-white/20 border border-white/30 text-white px-4 py-2 rounded-lg placeholder-white\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-4 mb-4\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>setTextEditMode(!textEditMode),className:\"px-4 py-2 rounded-lg transition \".concat(textEditMode?'bg-green-500 text-white':'bg-white/20 text-white hover:bg-white/30'),children:textEditMode?'✓ Mode texte activé':'✏️ Activer mode texte'}),textEditMode&&/*#__PURE__*/_jsx(\"span\",{className:\"text-sm opacity-75\",children:\"Cliquez sur l'aper\\xE7u pour ajouter du texte\"})]}),customTexts.length>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"mb-4\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-semibold mb-2\",children:\"Textes personnalis\\xE9s:\"}),/*#__PURE__*/_jsx(\"div\",{className:\"space-y-2\",children:customTexts.map(textObj=>/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-2\",children:[textObj.isEditing?/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:editingText,onChange:e=>setEditingText(e.target.value),onBlur:()=>{updateCustomText(textObj.id,editingText);setEditingText('');},onKeyDown:e=>{if(e.key==='Enter'){updateCustomText(textObj.id,editingText);setEditingText('');}},className:\"bg-white/20 border border-white/30 text-white px-2 py-1 rounded text-sm flex-1\",autoFocus:true}):/*#__PURE__*/_jsxs(\"span\",{className:\"text-sm flex-1\",children:[\"\\\"\",textObj.text,\"\\\"\"]}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>removeCustomText(textObj.id),className:\"bg-red-500/70 hover:bg-red-500 text-white px-2 py-1 rounded text-xs\",children:\"Supprimer\"})]},textObj.id))})]}),/*#__PURE__*/_jsx(\"h2\",{className:\"text-2xl font-semibold mb-4\",children:\"5. Aper\\xE7u\"}),/*#__PURE__*/_jsx(\"div\",{className:\"relative bg-white rounded-xl overflow-hidden shadow-xl p-4 max-w-2xl mx-auto mb-6\",children:preview?/*#__PURE__*/_jsxs(\"div\",{className:\"relative\",children:[/*#__PURE__*/_jsx(\"canvas\",{ref:canvasRef,onClick:handleCanvasClick,className:\"w-full rounded-md \".concat(textEditMode?'cursor-crosshair':''),style:{display:'none'}}),/*#__PURE__*/_jsx(\"img\",{src:preview,alt:\"preview\",className:\"w-full rounded-md \".concat(textEditMode?'cursor-crosshair':''),onClick:handleCanvasClick}),textEditMode&&/*#__PURE__*/_jsx(\"div\",{className:\"absolute top-2 left-2 bg-black/70 text-white px-2 py-1 rounded text-xs\",children:\"Mode texte: cliquez pour ajouter\"})]}):/*#__PURE__*/_jsx(\"div\",{className:\"aspect-video bg-gray-200 rounded-md flex items-center justify-center text-gray-500\",children:\"Aper\\xE7u du meme\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-wrap gap-4 justify-center\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:handleSaveMeme,disabled:isSaving,className:\"action-btn save-btn\",children:isSaving?'💾 Sauvegarde...':'💾 Sauvegarder'}),/*#__PURE__*/_jsx(\"button\",{onClick:handleDownload,className:\"action-btn download-btn\",children:\"\\uD83D\\uDCE5 T\\xE9l\\xE9charger\"}),/*#__PURE__*/_jsx(\"button\",{onClick:handleShare,className:\"action-btn share-btn\",children:\"\\uD83D\\uDCE4 Partager\"}),/*#__PURE__*/_jsx(\"button\",{onClick:resetForm,className:\"action-btn reset-btn\",children:\"\\uD83D\\uDD04 Nouveau\"})]})]})]})]});};export default MemeGenerator;","map":{"version":3,"names":["React","useState","useRef","useEffect","axios","html2canvas","toast","InteractifGen","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","MemeGenerator","selectedImages","setSelectedImages","imageUrl","setImageUrl","cloudinaryId","setCloudinaryId","topText","setTopText","bottomText","setBottomText","title","setTitle","isUploading","setIsUploading","isSaving","setIsSaving","preview","setPreview","displayMode","setDisplayMode","customTexts","setCustomTexts","textEditMode","setTextEditMode","activeImageIndex","setActiveImageIndex","textColor","setTextColor","textBgColor","setTextBgColor","textBgOpacity","setTextBgOpacity","editingText","setEditingText","showCustomEditor","setShowCustomEditor","memeRef","canvasRef","hexToRgba","hex","opacity","r","parseInt","slice","g","b","concat","displayModes","single","name","maxImages","horizontal","vertical","grid2x2","handleImageUpload","event","files","Array","from","target","length","error","validFiles","filter","file","size","newImages","map","URL","createObjectURL","id","Date","now","Math","random","prev","setTimeout","removeImage","imageId","updated","img","removedImage","find","revokeObjectURL","text","imageIndex","handleCanvasClick","canvas","current","rect","getBoundingClientRect","x","clientX","left","width","naturalWidth","y","clientY","top","height","naturalHeight","newText","color","bgColor","bgOpacity","isEditing","updateCustomText","textId","t","_objectSpread","removeCustomText","generateMemeImage","Promise","resolve","reject","document","createElement","ctx","getContext","canvasWidth","canvasHeight","imagesLoaded","totalImages","drawTextsOnCanvas","topFontSize","floor","topTextY","font","textAlign","textBaseline","textMetrics","measureText","textWidth","textHeight","padding","rectX","rectY","rectWidth","rectHeight","fillStyle","fillRect","strokeStyle","lineWidth","strokeText","fillText","bottomFontSize","bottomTextY","forEach","textObj","fontSize","toString","padStart","onImageLoad","toBlob","blob","url","Error","imageData","index","Image","onload","aspectRatio","targetAspect","drawWidth","drawHeight","offsetX","offsetY","drawImage","onerror","console","src","handleChangeTop","value","handleChangeBot","timeoutId","catch","clearTimeout","handleSaveMeme","trim","formData","FormData","append","uploadResponse","post","headers","memeData","data","success","resetForm","_error$response","_error$response$data","response","message","handleDownload","fetch","link","download","href","click","handleShare","File","type","navigator","canShare","share","clipboard","writeText","handleCustomEditorSave","canvasData","log","className","children","onClick","onClose","onSave","Object","entries","_ref","mode","info","excess","htmlFor","accept","multiple","onChange","alt","e","round","min","max","step","parseFloat","placeholder","onBlur","onKeyDown","key","autoFocus","ref","style","display","disabled"],"sources":["C:/Users/AZIZ/Desktop/gen_meme/client/src/components/MemeGenerator.js"],"sourcesContent":["import React, { useState, useRef, useEffect } from 'react';\r\nimport axios from 'axios';\r\nimport html2canvas from 'html2canvas';\r\nimport toast from 'react-hot-toast';\r\nimport './component.css';\r\nimport InteractifGen from './InteractifGen';\r\n\r\nconst MemeGenerator = () => {\r\n    const [selectedImages, setSelectedImages] = useState([]);\r\n    const [imageUrl, setImageUrl] = useState('');\r\n    const [cloudinaryId, setCloudinaryId] = useState('');\r\n    const [topText, setTopText] = useState('');\r\n    const [bottomText, setBottomText] = useState('');\r\n    const [title, setTitle] = useState('');\r\n    const [isUploading, setIsUploading] = useState(false);\r\n    const [isSaving, setIsSaving] = useState(false);\r\n    const [preview, setPreview] = useState(null);\r\n    const [displayMode, setDisplayMode] = useState('single');\r\n    const [customTexts, setCustomTexts] = useState([]);\r\n    const [textEditMode, setTextEditMode] = useState(false);\r\n    const [activeImageIndex, setActiveImageIndex] = useState(0);\r\n    const [textColor, setTextColor] = useState('#ffffff');\r\n    const [textBgColor, setTextBgColor] = useState('#000000');\r\n    const [textBgOpacity, setTextBgOpacity] = useState(0.7);\r\n    const [editingText, setEditingText] = useState('');\r\n    const [showCustomEditor, setShowCustomEditor] = useState(false);\r\n\r\n    const memeRef = useRef(null);\r\n    const canvasRef = useRef(null);\r\n\r\n    function hexToRgba(hex, opacity) {\r\n        const r = parseInt(hex.slice(1, 3), 16);\r\n        const g = parseInt(hex.slice(3, 5), 16);\r\n        const b = parseInt(hex.slice(5, 7), 16);\r\n        return `rgba(${r}, ${g}, ${b}, ${opacity})`;\r\n    }\r\n\r\n\r\n    const displayModes = {\r\n        single: { name: 'Image unique', maxImages: 1 },\r\n        horizontal: { name: 'Horizontal (2)', maxImages: 2 },\r\n        vertical: { name: 'Vertical (2)', maxImages: 2 },\r\n        grid2x2: { name: 'Grille 2x2', maxImages: 4 }\r\n    };\r\n\r\n    const handleImageUpload = async (event) => {\r\n        const files = Array.from(event.target.files);\r\n        const maxImages = displayModes[displayMode].maxImages;\r\n\r\n        if (selectedImages.length + files.length > maxImages) {\r\n            toast.error(`Maximum ${maxImages} image(s) pour ce mode d'affichage`);\r\n            return;\r\n        }\r\n\r\n        const validFiles = files.filter(file => {\r\n            if (file.size > 5 * 1024 * 1024) {\r\n                toast.error(`${file.name} est trop volumineux (max 5MB)`);\r\n                return false;\r\n            }\r\n            return true;\r\n        });\r\n\r\n        const newImages = validFiles.map(file => ({\r\n            file,\r\n            preview: URL.createObjectURL(file),\r\n            id: Date.now() + Math.random()\r\n        }));\r\n\r\n        setSelectedImages(prev => [...prev, ...newImages]);\r\n        if (validFiles.length > 0) {\r\n            setIsUploading(true);\r\n            setTimeout(() => setIsUploading(false), 1000);\r\n        }\r\n    };\r\n\r\n    const removeImage = (imageId) => {\r\n        setSelectedImages(prev => {\r\n            const updated = prev.filter(img => img.id !== imageId);\r\n            // Libérer l'URL de l'image supprimée\r\n            const removedImage = prev.find(img => img.id === imageId);\r\n            if (removedImage) {\r\n                URL.revokeObjectURL(removedImage.preview);\r\n            }\r\n            return updated;\r\n        });\r\n\r\n        // Nettoyer les textes personnalisés associés à cette image\r\n        setCustomTexts(prev => prev.filter(text => text.imageIndex !== imageId));\r\n    };\r\n\r\n    const handleCanvasClick = (event) => {\r\n        if (!textEditMode || selectedImages.length === 0) return;\r\n\r\n        const canvas = canvasRef.current;\r\n        if (!canvas) return;\r\n\r\n        const img = event.target;\r\n        const rect = img.getBoundingClientRect();\r\n\r\n        const x = ((event.clientX - rect.left) / rect.width) * img.naturalWidth;\r\n        const y = ((event.clientY - rect.top) / rect.height) * img.naturalHeight;\r\n\r\n        const newText = {\r\n            id: Date.now(),\r\n            text: 'Nouveau texte',\r\n            x: x,\r\n            y: y,\r\n            imageIndex: activeImageIndex,\r\n            color: textColor,\r\n            bgColor: textBgColor,\r\n            bgOpacity: textBgOpacity,\r\n            isEditing: true\r\n        };\r\n\r\n        setCustomTexts(prev => [...prev, newText]);\r\n    };\r\n\r\n    const updateCustomText = (textId, newText) => {\r\n        setCustomTexts(prev => prev.map(t =>\r\n            t.id === textId ? { ...t, text: newText, isEditing: false } : t\r\n        ));\r\n    };\r\n\r\n    const removeCustomText = (textId) => {\r\n        setCustomTexts(prev => prev.filter(t => t.id !== textId));\r\n    };\r\n\r\n    const generateMemeImage = async () => {\r\n        if (selectedImages.length === 0) return null;\r\n\r\n        return new Promise((resolve, reject) => {\r\n            const canvas = document.createElement(\"canvas\");\r\n            const ctx = canvas.getContext(\"2d\");\r\n\r\n            // Dimensions du canvas selon le mode d'affichage\r\n            let canvasWidth = 800;\r\n            let canvasHeight = 600;\r\n\r\n            if (displayMode === 'horizontal') {\r\n                canvasWidth = 1200;\r\n                canvasHeight = 600;\r\n            } else if (displayMode === 'vertical') {\r\n                canvasWidth = 600;\r\n                canvasHeight = 1200;\r\n            } else if (displayMode === 'grid2x2') {\r\n                canvasWidth = 1000;\r\n                canvasHeight = 1000;\r\n            }\r\n\r\n            canvas.width = canvasWidth;\r\n            canvas.height = canvasHeight;\r\n\r\n            let imagesLoaded = 0;\r\n            const totalImages = selectedImages.length;\r\n\r\n            const drawTextsOnCanvas = () => {\r\n                // Texte du haut (global)\r\n                if (topText) {\r\n                    const topFontSize = Math.floor(canvasWidth / 15);\r\n                    const topTextY = 20;\r\n\r\n                    ctx.font = `bold ${topFontSize}px Impact`;\r\n                    ctx.textAlign = \"center\";\r\n                    ctx.textBaseline = \"top\";\r\n\r\n                    const textMetrics = ctx.measureText(topText); // CORRIGÉ\r\n                    const textWidth = textMetrics.width;\r\n                    const textHeight = topFontSize;\r\n\r\n                    if (textBgOpacity > 0) {\r\n                        const padding = 10;\r\n                        const rectX = canvasWidth / 2 - textWidth / 2 - padding;\r\n                        const rectY = topTextY - padding / 2;\r\n                        const rectWidth = textWidth + padding * 2;\r\n                        const rectHeight = textHeight + padding;\r\n\r\n                        ctx.fillStyle = hexToRgba(textBgColor, textBgOpacity); // CORRIGÉ\r\n                        ctx.fillRect(rectX, rectY, rectWidth, rectHeight);\r\n                    }\r\n\r\n                    ctx.fillStyle = textColor;\r\n                    ctx.strokeStyle = \"#000000\";\r\n                    ctx.lineWidth = 3;\r\n                    ctx.strokeText(topText, canvasWidth / 2, topTextY);\r\n                    ctx.fillText(topText, canvasWidth / 2, topTextY);\r\n                }\r\n\r\n\r\n\r\n                if (bottomText) {\r\n                    const bottomFontSize = Math.floor(canvasWidth / 15);\r\n                    const bottomTextY = canvasHeight - 60;\r\n\r\n                    ctx.font = `bold ${bottomFontSize}px Impact`;\r\n                    ctx.textAlign = \"center\";\r\n                    ctx.textBaseline = \"bottom\";\r\n\r\n                    const textMetrics = ctx.measureText(bottomText);\r\n                    const textWidth = textMetrics.width;\r\n                    const textHeight = bottomFontSize;\r\n\r\n                    if (textBgOpacity > 0) {\r\n                        const padding = 10;\r\n                        const rectX = canvasWidth / 2 - textWidth / 2 - padding;\r\n                        const rectY = bottomTextY - textHeight - padding / 2;\r\n                        const rectWidth = textWidth + padding * 2;\r\n                        const rectHeight = textHeight + padding;\r\n\r\n                        ctx.fillStyle = hexToRgba(textBgColor, textBgOpacity); // CORRIGÉ\r\n                        ctx.fillRect(rectX, rectY, rectWidth, rectHeight);\r\n                    }\r\n\r\n                    ctx.fillStyle = textColor;\r\n                    ctx.strokeStyle = \"#000000\";\r\n                    ctx.lineWidth = 3;\r\n                    ctx.strokeText(bottomText, canvasWidth / 2, bottomTextY);\r\n                    ctx.fillText(bottomText, canvasWidth / 2, bottomTextY);\r\n                }\r\n\r\n\r\n                customTexts.forEach(textObj => {\r\n                    if (textObj.text && !textObj.isEditing) {\r\n                        const fontSize = Math.floor(canvasWidth / 20);\r\n                        ctx.font = `bold ${fontSize}px Impact`;\r\n                        ctx.textAlign = \"center\";\r\n                        ctx.textBaseline = \"middle\";\r\n\r\n                        // Fond du texte si nécessaire\r\n                        if (textObj.bgOpacity > 0) {\r\n                            const textWidth = ctx.measureText(textObj.text).width;\r\n                            const padding = 10;\r\n\r\n                            ctx.fillStyle = `${textObj.bgColor}${Math.floor(textObj.bgOpacity * 255).toString(16).padStart(2, '0')}`;\r\n                            ctx.fillRect(\r\n                                textObj.x - textWidth / 2 - padding,\r\n                                textObj.y - fontSize / 2 - padding / 2,\r\n                                textWidth + padding * 2,\r\n                                fontSize + padding\r\n                            );\r\n                        }\r\n\r\n                        // Texte\r\n                        ctx.fillStyle = textObj.color;\r\n                        ctx.strokeStyle = \"#000000\";\r\n                        ctx.lineWidth = 2;\r\n\r\n                        ctx.strokeText(textObj.text, textObj.x, textObj.y);\r\n                        ctx.fillText(textObj.text, textObj.x, textObj.y);\r\n                    }\r\n                });\r\n            };\r\n\r\n            const onImageLoad = () => {\r\n                imagesLoaded++;\r\n                if (imagesLoaded === totalImages) {\r\n                    drawTextsOnCanvas();\r\n                    canvas.toBlob((blob) => {\r\n                        if (blob) {\r\n                            const url = URL.createObjectURL(blob);\r\n                            setPreview(url);\r\n                            resolve(blob);\r\n                        } else {\r\n                            reject(new Error(\"Échec génération meme\"));\r\n                        }\r\n                    }, \"image/png\");\r\n                }\r\n            };\r\n\r\n            // Dessiner les images selon le mode d'affichage\r\n            selectedImages.forEach((imageData, index) => {\r\n                const img = new Image();\r\n                img.onload = () => {\r\n                    let x = 0, y = 0, width = canvasWidth, height = canvasHeight;\r\n\r\n                    if (displayMode === 'horizontal' && selectedImages.length === 2) {\r\n                        width = canvasWidth / 2;\r\n                        x = index * width;\r\n                    } else if (displayMode === 'vertical' && selectedImages.length === 2) {\r\n                        height = canvasHeight / 2;\r\n                        y = index * height;\r\n                    } else if (displayMode === 'grid2x2') {\r\n                        width = canvasWidth / 2;\r\n                        height = canvasHeight / 2;\r\n                        x = (index % 2) * width;\r\n                        y = Math.floor(index / 2) * height;\r\n                    }\r\n\r\n                    // Remplir la zone avec un fond blanc\r\n                    ctx.fillStyle = \"white\";\r\n                    ctx.fillRect(x, y, width, height);\r\n\r\n                    // Maintenir le ratio d'aspect et centrer\r\n                    const aspectRatio = img.width / img.height;\r\n                    const targetAspect = width / height;\r\n                    let drawWidth = width;\r\n                    let drawHeight = height;\r\n                    let offsetX = 0;\r\n                    let offsetY = 0;\r\n\r\n                    if (aspectRatio > targetAspect) {\r\n                        // Image plus large que la case\r\n                        drawWidth = width;\r\n                        drawHeight = width / aspectRatio;\r\n                        offsetY = (height - drawHeight) / 2;\r\n                    } else {\r\n                        // Image plus haute que la case\r\n                        drawHeight = height;\r\n                        drawWidth = height * aspectRatio;\r\n                        offsetX = (width - drawWidth) / 2;\r\n                    }\r\n\r\n                    ctx.drawImage(img, x + offsetX, y + offsetY, drawWidth, drawHeight);\r\n                    onImageLoad();\r\n                };\r\n\r\n\r\n                img.onerror = () => {\r\n                    console.error(\"Erreur chargement image\");\r\n                    onImageLoad();\r\n                };\r\n\r\n                img.src = imageData.preview;\r\n            });\r\n        });\r\n    };\r\n\r\n    const handleChangeTop = (event) => {\r\n        setTopText(event.target.value);\r\n    };\r\n\r\n    const handleChangeBot = (event) => {\r\n        setBottomText(event.target.value);\r\n    };\r\n\r\n    useEffect(() => {\r\n        if (selectedImages.length > 0) {\r\n            const timeoutId = setTimeout(() => {\r\n                generateMemeImage().catch(console.error);\r\n            }, 300);\r\n\r\n            return () => clearTimeout(timeoutId);\r\n        }\r\n    }, [selectedImages, topText, bottomText, customTexts, displayMode, textColor, textBgColor, textBgOpacity]);\r\n\r\n    const handleSaveMeme = async () => {\r\n        if (!title.trim()) {\r\n            toast.error('Veuillez ajouter un titre');\r\n            return;\r\n        }\r\n\r\n        setIsSaving(true);\r\n        try {\r\n            // Étape 1: Générer et uploader l'image\r\n            const blob = await generateMemeImage();\r\n            if (!blob) {\r\n                toast.error(\"Impossible de générer l'image\");\r\n                return;\r\n            }\r\n\r\n            const formData = new FormData();\r\n            formData.append('image', blob, 'meme.png');\r\n\r\n            // Upload vers Cloudinary\r\n            const uploadResponse = await axios.post(\"http://localhost:5000/api/upload\", formData, {\r\n                headers: {\r\n                    'Content-Type': 'multipart/form-data',\r\n                },\r\n            });\r\n\r\n            // Étape 2: Sauvegarder les métadonnées en base de données\r\n            const memeData = {\r\n                title: title.trim(),\r\n                imageUrl: uploadResponse.data.imageUrl,\r\n                cloudinaryId: uploadResponse.data.cloudinaryId,\r\n            };\r\n\r\n            await axios.post('http://localhost:5000/api/memes', memeData);\r\n\r\n            toast.success('Meme sauvegardé avec succès!');\r\n            resetForm();\r\n        } catch (error) {\r\n            console.error('Erreur:', error);\r\n            toast.error(error.response?.data?.message || 'Erreur lors de la sauvegarde');\r\n        } finally {\r\n            setIsSaving(false);\r\n        }\r\n    };\r\n\r\n    const handleDownload = async () => {\r\n        if (!preview) return;\r\n\r\n        try {\r\n            const response = await fetch(preview);\r\n            const blob = await response.blob();\r\n            const url = URL.createObjectURL(blob);\r\n\r\n            const link = document.createElement('a');\r\n            link.download = `${title || 'meme'}.png`;\r\n            link.href = url;\r\n            link.click();\r\n\r\n            URL.revokeObjectURL(url);\r\n            toast.success('Meme téléchargé!');\r\n        } catch (error) {\r\n            console.error('Erreur téléchargement:', error);\r\n            toast.error('Erreur lors du téléchargement');\r\n        }\r\n    };\r\n\r\n    const resetForm = () => {\r\n        selectedImages.forEach(img => URL.revokeObjectURL(img.preview));\r\n        setSelectedImages([]);\r\n        setImageUrl('');\r\n        setCloudinaryId('');\r\n        setTopText('');\r\n        setBottomText('');\r\n        setTitle('');\r\n        setCustomTexts([]);\r\n        setPreview(null);\r\n        setActiveImageIndex(0);\r\n    };\r\n\r\n    const handleShare = async () => {\r\n        if (!preview) return;\r\n\r\n        try {\r\n            const response = await fetch(preview);\r\n            const blob = await response.blob();\r\n            const file = new File([blob], 'meme.png', { type: blob.type });\r\n\r\n            if (navigator.canShare && navigator.canShare({ files: [file] })) {\r\n                await navigator.share({\r\n                    title: `Meme: ${title}`,\r\n                    text: `Regardez ce meme que j'ai créé : ${title}`,\r\n                    files: [file],\r\n                });\r\n            } else {\r\n                navigator.clipboard.writeText(preview);\r\n                toast.success('URL copiée dans le presse-papier');\r\n            }\r\n        } catch (error) {\r\n            console.error(\"Erreur lors du partage:\", error);\r\n            toast.error(\"Partage impossible.\");\r\n        }\r\n    };\r\n\r\n    // CANVA \r\n    const handleCustomEditorSave = (canvasData) => {\r\n        // Ici vous pouvez traiter les données du canvas personnalisé\r\n        // Par exemple, les sauvegarder ou les intégrer à votre flux existant\r\n        console.log('Canvas personnalisé sauvegardé:', canvasData);\r\n        setShowCustomEditor(false);\r\n    };\r\n\r\n    return (\r\n        <div className=\"meme-generator px-4 py-8 max-w-6xl mx-auto text-white \">\r\n            <h1 className=\"text-4xl font-bold mb-8 text-center\">Créateur de Memes</h1>\r\n\r\n            <div className=\"mb-6\">\r\n                <button\r\n                    onClick={() => setShowCustomEditor(true)}\r\n                    className=\"w-full flex items-center justify-center gap-3 px-6 py-4 bg-gradient-to-r from-purple-500 to-pink-500 text-white font-semibold rounded-xl hover:from-purple-600 hover:to-pink-600 transition-all duration-300 shadow-lg hover:shadow-xl transform hover:scale-105\"\r\n                >\r\n                    <span>Mode Personnalisation</span>\r\n                </button>\r\n                <p className=\"text-center text-sm text-white/70 mt-2\">\r\n                    Créez librement avec des outils de type Canva\r\n                </p>\r\n            </div>\r\n\r\n            {/* Et ajoutez ceci à la fin de votre JSX, juste avant la fermeture du div principal */}\r\n            {showCustomEditor && (\r\n                <InteractifGen\r\n                    onClose={() => setShowCustomEditor(false)}\r\n                    onSave={handleCustomEditorSave}\r\n                />\r\n            )}\r\n\r\n            <div className=\"bg-white/10 backdrop-blur-lg rounded-2xl p-6 shadow-2xl\">\r\n                {/* Section Mode d'affichage */}\r\n                <h2 className=\"text-2xl font-semibold mb-4\">1. Mode d'affichage</h2>\r\n                <div className=\"grid grid-cols-2 lg:grid-cols-4 gap-2 mb-6\">\r\n                    {Object.entries(displayModes).map(([mode, info]) => (\r\n                        <button\r\n                            key={mode}\r\n                            onClick={() => {\r\n                                setDisplayMode(mode);\r\n                                // Limiter les images selon le nouveau mode\r\n                                const maxImages = info.maxImages;\r\n                                if (selectedImages.length > maxImages) {\r\n                                    const excess = selectedImages.slice(maxImages);\r\n                                    excess.forEach(img => URL.revokeObjectURL(img.preview));\r\n                                    setSelectedImages(prev => prev.slice(0, maxImages));\r\n                                }\r\n                            }}\r\n                            className={`p-3 rounded-lg border-2 transition ${displayMode === mode\r\n                                ? 'border-blue-400 bg-blue-500/30'\r\n                                : 'border-white/30 bg-white/10 hover:bg-white/20'\r\n                                }`}\r\n                        >\r\n                            <div className=\"text-sm font-medium\">{info.name}</div>\r\n                            <div className=\"text-xs opacity-75\">Max: {info.maxImages}</div>\r\n                        </button>\r\n                    ))}\r\n                </div>\r\n\r\n                {/* Section Upload */}\r\n                <h2 className=\"text-2xl font-semibold mb-4\">2. Ajouter des images</h2>\r\n                <div className=\"mb-6\">\r\n                    <label htmlFor=\"image-upload\" className=\"cursor-pointer block w-full text-center py-4 border-2 border-dashed border-white/50 rounded-xl hover:bg-white/10 transition\">\r\n                        {isUploading ? \"📤 Upload en cours...\" : `📸 Ajouter des images (${selectedImages.length}/${displayModes[displayMode].maxImages})`}\r\n                    </label>\r\n                    <input\r\n                        id=\"image-upload\"\r\n                        type=\"file\"\r\n                        accept=\"image/*\"\r\n                        multiple={displayModes[displayMode].maxImages > 1}\r\n                        onChange={handleImageUpload}\r\n                        className=\"hidden\"\r\n                    />\r\n                </div>\r\n\r\n                {/* Images uploadées */}\r\n                {selectedImages.length > 0 && (\r\n                    <div className=\"grid grid-cols-2 lg:grid-cols-4 gap-4 mb-6\">\r\n                        {selectedImages.map((img, index) => (\r\n                            <div key={img.id} className=\"relative group\">\r\n                                <img\r\n                                    src={img.preview}\r\n                                    alt={`Upload ${index + 1}`}\r\n                                    className={`w-full h-24 object-cover rounded-lg border-2 cursor-pointer transition ${activeImageIndex === index ? 'border-blue-400' : 'border-white/30'\r\n                                        }`}\r\n                                    onClick={() => setActiveImageIndex(index)}\r\n                                />\r\n                                <button\r\n                                    onClick={() => removeImage(img.id)}\r\n                                    className=\"absolute -top-2 -right-2 bg-red-500 text-white rounded-full w-6 h-6 flex items-center justify-center text-xs opacity-0 group-hover:opacity-100 transition\"\r\n                                >\r\n                                    ✕\r\n                                </button>\r\n                                {activeImageIndex === index && (\r\n                                    <div className=\"absolute inset-0 bg-blue-500/20 rounded-lg flex items-center justify-center\">\r\n                                        <span className=\"text-xs font-bold\">ACTIF</span>\r\n                                    </div>\r\n                                )}\r\n                            </div>\r\n                        ))}\r\n                    </div>\r\n                )}\r\n\r\n                {/* Configuration du texte */}\r\n                {selectedImages.length > 0 && (\r\n                    <>\r\n                        <h2 className=\"text-2xl font-semibold mb-4\">3. Configuration du texte</h2>\r\n                        <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-4 mb-6\">\r\n                            <div>\r\n                                <label className=\"block text-sm mb-2\">Couleur du texte</label>\r\n                                <input\r\n                                    type=\"color\"\r\n                                    value={textColor}\r\n                                    onChange={(e) => setTextColor(e.target.value)}\r\n                                    className=\"w-full h-10 rounded border-none\"\r\n                                />\r\n                            </div>\r\n                            <div>\r\n                                <label className=\"block text-sm mb-2\">Couleur du fond</label>\r\n                                <input\r\n                                    type=\"color\"\r\n                                    value={textBgColor}\r\n                                    onChange={(e) => setTextBgColor(e.target.value)}\r\n                                    className=\"w-full h-10 rounded border-none\"\r\n                                />\r\n                            </div>\r\n                            <div>\r\n                                <label className=\"block text-sm mb-2\">Opacité du fond: {Math.round(textBgOpacity * 100)}%</label>\r\n                                <input\r\n                                    type=\"range\"\r\n                                    min=\"0\"\r\n                                    max=\"1\"\r\n                                    step=\"0.1\"\r\n                                    value={textBgOpacity}\r\n                                    onChange={(e) => setTextBgOpacity(parseFloat(e.target.value))}\r\n                                    className=\"w-full\"\r\n                                />\r\n                            </div>\r\n                        </div>\r\n\r\n                        {/* Section Texte */}\r\n                        <h2 className=\"text-2xl font-semibold mb-4\">4. Ajouter du texte</h2>\r\n                        <div className=\"grid grid-cols-1 sm:grid-cols-2 gap-4 mb-4\">\r\n                            <input\r\n                                type=\"text\"\r\n                                placeholder=\"Titre du meme\"\r\n                                value={title}\r\n                                onChange={(e) => setTitle(e.target.value)}\r\n                                className=\"bg-white/20 border border-white/30 text-white px-4 py-2 rounded-lg placeholder-white sm:col-span-2\"\r\n                            />\r\n                            <input\r\n                                type=\"text\"\r\n                                placeholder=\"Texte du haut\"\r\n                                value={topText}\r\n                                onChange={handleChangeTop}\r\n                                className=\"bg-white/20 border border-white/30 text-white px-4 py-2 rounded-lg placeholder-white\"\r\n                            />\r\n                            <input\r\n                                type=\"text\"\r\n                                placeholder=\"Texte du bas\"\r\n                                value={bottomText}\r\n                                onChange={handleChangeBot}\r\n                                className=\"bg-white/20 border border-white/30 text-white px-4 py-2 rounded-lg placeholder-white\"\r\n                            />\r\n                        </div>\r\n\r\n                        <div className=\"flex items-center gap-4 mb-4\">\r\n                            <button\r\n                                onClick={() => setTextEditMode(!textEditMode)}\r\n                                className={`px-4 py-2 rounded-lg transition ${textEditMode\r\n                                    ? 'bg-green-500 text-white'\r\n                                    : 'bg-white/20 text-white hover:bg-white/30'\r\n                                    }`}\r\n                            >\r\n                                {textEditMode ? '✓ Mode texte activé' : '✏️ Activer mode texte'}\r\n                            </button>\r\n                            {textEditMode && (\r\n                                <span className=\"text-sm opacity-75\">\r\n                                    Cliquez sur l'aperçu pour ajouter du texte\r\n                                </span>\r\n                            )}\r\n                        </div>\r\n\r\n                        {/* Textes personnalisés */}\r\n                        {customTexts.length > 0 && (\r\n                            <div className=\"mb-4\">\r\n                                <h3 className=\"text-lg font-semibold mb-2\">Textes personnalisés:</h3>\r\n                                <div className=\"space-y-2\">\r\n                                    {customTexts.map((textObj) => (\r\n                                        <div key={textObj.id} className=\"flex items-center gap-2\">\r\n                                            {textObj.isEditing ? (\r\n                                                <input\r\n                                                    type=\"text\"\r\n                                                    value={editingText}\r\n                                                    onChange={(e) => setEditingText(e.target.value)}\r\n                                                    onBlur={() => {\r\n                                                        updateCustomText(textObj.id, editingText);\r\n                                                        setEditingText('');\r\n                                                    }}\r\n                                                    onKeyDown={(e) => {\r\n                                                        if (e.key === 'Enter') {\r\n                                                            updateCustomText(textObj.id, editingText);\r\n                                                            setEditingText('');\r\n                                                        }\r\n                                                    }}\r\n                                                    className=\"bg-white/20 border border-white/30 text-white px-2 py-1 rounded text-sm flex-1\"\r\n                                                    autoFocus\r\n                                                />\r\n                                            ) : (\r\n                                                <span className=\"text-sm flex-1\">\"{textObj.text}\"</span>\r\n                                            )}\r\n\r\n                                            <button\r\n                                                onClick={() => removeCustomText(textObj.id)}\r\n                                                className=\"bg-red-500/70 hover:bg-red-500 text-white px-2 py-1 rounded text-xs\"\r\n                                            >\r\n                                                Supprimer\r\n                                            </button>\r\n                                        </div>\r\n                                    ))}\r\n                                </div>\r\n                            </div>\r\n                        )}\r\n\r\n                        {/* Aperçu */}\r\n                        <h2 className=\"text-2xl font-semibold mb-4\">5. Aperçu</h2>\r\n                        <div className=\"relative bg-white rounded-xl overflow-hidden shadow-xl p-4 max-w-2xl mx-auto mb-6\">\r\n                            {preview ? (\r\n                                <div className=\"relative\">\r\n                                    <canvas\r\n                                        ref={canvasRef}\r\n                                        onClick={handleCanvasClick}\r\n                                        className={`w-full rounded-md ${textEditMode ? 'cursor-crosshair' : ''}`}\r\n                                        style={{ display: 'none' }}\r\n                                    />\r\n                                    <img\r\n                                        src={preview}\r\n                                        alt=\"preview\"\r\n                                        className={`w-full rounded-md ${textEditMode ? 'cursor-crosshair' : ''}`}\r\n                                        onClick={handleCanvasClick}\r\n                                    />\r\n                                    {textEditMode && (\r\n                                        <div className=\"absolute top-2 left-2 bg-black/70 text-white px-2 py-1 rounded text-xs\">\r\n                                            Mode texte: cliquez pour ajouter\r\n                                        </div>\r\n                                    )}\r\n                                </div>\r\n                            ) : (\r\n                                <div className=\"aspect-video bg-gray-200 rounded-md flex items-center justify-center text-gray-500\">\r\n                                    Aperçu du meme\r\n                                </div>\r\n                            )}\r\n                        </div>\r\n\r\n                        {/* Actions */}\r\n                        <div className=\"flex flex-wrap gap-4 justify-center\">\r\n                            <button onClick={handleSaveMeme} disabled={isSaving} className=\"action-btn save-btn\">\r\n                                {isSaving ? '💾 Sauvegarde...' : '💾 Sauvegarder'}\r\n                            </button>\r\n                            <button onClick={handleDownload} className=\"action-btn download-btn\">\r\n                                📥 Télécharger\r\n                            </button>\r\n                            <button onClick={handleShare} className=\"action-btn share-btn\">\r\n                                📤 Partager\r\n                            </button>\r\n                            <button onClick={resetForm} className=\"action-btn reset-btn\">\r\n                                🔄 Nouveau\r\n                            </button>\r\n                        </div>\r\n                    </>\r\n                )}\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default MemeGenerator;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}